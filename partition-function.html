
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Reverse Rates &#8212; pynucastro 2.4.0.post66+gfc8716f3 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css?v=15ab05d9" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=dfbceeb8"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'partition-function';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Approximate Rates" href="approximate-rates.html" />
    <link rel="prev" title="Creating a Custom Rate" href="custom-rates.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.4" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt=""/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">pynucastro 2.4</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Overview of pynucastro</a></li>
<li class="toctree-l1"><a class="reference internal" href="rate_types.html">Reaction Rate Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Nuclear Properties</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="sources.html">Third Party Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="nucleus.html">Nuclear Properties</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploring Networks in Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pynucastro-examples.html">pynucastro Usage Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-types.html">Plotting Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="pynucastro-integration.html">Integrating a Network</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Building Networks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="library-examples.html">Selecting Rates from a Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="duplicate-rates.html">Dealing with Duplicate Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="validate-example.html">Checking Your Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="electron-capture-example.html">Tabulated Weak Rate Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="electron-captures.html">Combining ReacLib Rates with Electron Capture Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="alternate-rates.html"><code class="docutils literal notranslate"><span class="pre">alternate_rates</span></code></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Rate Operations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="screening-examples.html">Screening Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="modify-example.html">Modifying Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom-rates.html">Creating a Custom Rate</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Reverse Rates</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Network Operations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="approximate-rates.html">Approximate Rates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="alpha-gamma-approx.html">Approximating alpha-capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="double-n-capture.html">Approximating double n-capture</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="nse-protons.html">Using NSE Protons</a></li>
<li class="toctree-l1"><a class="reference internal" href="unimportant-rates.html">Removing Unimportant Rates</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Nuclear Statistical Equilibrium</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="NSE-example.html">Solving for Nuclear Statistical Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="nse_table.html">Creating an NSE table</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Plasma Neutrinos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="neutrino-cooling.html">Neutrino Cooling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exporting Networks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="networks.html">Exporting Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="python-network.html">Python network</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple-cxx-network.html">Simple C++ network</a></li>
<li class="toctree-l1"><a class="reference internal" href="fortran-network.html">Fortran Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="amrex-astro-cxx-networks.html">AMReX Astro Microphysics Networks</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="julia.html">Integrating using DifferentialEquations.jl</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="installing-diffeqpy-julia.html">Installing <code class="docutils literal notranslate"><span class="pre">diffeqpy</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="Example-Integrating-Network-diffeqpy.html">Example of Integrating a Network</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Some Useful Networks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="he-burning-example.html">A He-burning Network</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples in Nuclear Astrophysics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="examples/binding-energy.html">Binding Energy per Nucleon</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/pp-cno.html">p-p chain vs. CNO</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/hot-CNO-breakout-example.html">hot-CNO and breakout</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/triple_alpha_eval.html">Computing the Screened Triple-alpha rate</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/he-burning.html">Ratio of C/O from He burning</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/supernova-lightcurve.html">A Supernova Lightcurve</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing pynucastro</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Changelog</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="modules.html">API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="pynucastro.html">pynucastro package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pynucastro.networks.html">pynucastro.networks package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pynucastro.nucdata.html">pynucastro.nucdata package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pynucastro.rates.html">pynucastro.rates package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pynucastro.reduction.html">pynucastro.reduction package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pynucastro.screening.html">pynucastro.screening package</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Index</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="py-modindex.html">Module Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pynucastro/pynucastro" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pynucastro/pynucastro/blob/main/docs/source/partition-function.rst?plain=1" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pynucastro/pynucastro/edit/main/docs/source/partition-function.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pynucastro/pynucastro/issues/new?title=Issue%20on%20page%20%2Fpartition-function.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/partition-function.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Reverse Rates</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#semi-relativistic-ideal-gas-model">Semi-relativistic ideal gas model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reverse-rate-definition">Reverse rate definition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-functions">Partition functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-partition-functions">Implementing partition functions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="reverse-rates">
<h1>Reverse Rates<a class="headerlink" href="#reverse-rates" title="Link to this heading">#</a></h1>
<p>In this section we will implement the partition functions discussed in
<span id="id1">Rauscher and Thielemann [<a class="reference internal" href="zreferences.html#id22" title="Thomas Rauscher and Friedrich-Karl Thielemann. Astrophysical Reaction Rates From Statistical Model Calculations. Atomic Data and Nuclear Data Tables, 75(1-2):1-351, May 2000. arXiv:astro-ph/0004059, doi:10.1006/adnd.2000.0834.">2000</a>]</span> and <span id="id2">Rauscher [<a class="reference internal" href="zreferences.html#id23" title="T. Rauscher. Nuclear partition functions at temperatures exceeding 10^10 K. The Astrophysical Journal Supplement Series, 147(2):403, August 2003. doi:10.1086/375733.">2003</a>]</span>
with the purpose to compute inverse rates at extreme temperatures and heavy nuclide conditions.</p>
<section id="semi-relativistic-ideal-gas-model">
<h2>Semi-relativistic ideal gas model<a class="headerlink" href="#semi-relativistic-ideal-gas-model" title="Link to this heading">#</a></h2>
<p>In order to illustrate our implementation, we will start first by computing the number density of reaction specie in terms of its chemical potential. Let us start our discussion by introducing the 1-particle <em>canonical partition function</em> by</p>
<div class="math notranslate nohighlight">
\[Z_{1-p} = \dfrac{g}{(2\pi \hbar)^3} \int \, d^3q \,d^3p \, \exp(-E/(kT))\]</div>
<p>Our purpose is to compute the number density in terms of the chemical potential by assuming a first order velocity approximation of the energy
for each particle as:</p>
<div class="math notranslate nohighlight">
\[E = \dfrac{p^2}{2m} + mc^2\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
Z_{1-p} &amp;=&amp; e^{-mc^2/(kT)}\times\dfrac{g}{(2\pi \hbar)^3} \int \, d^3q \,d^3p \, \exp(-p^2/(2mkT)) \\
        &amp;=&amp; e^{-mc^2/(kT)}\times gV\left(\dfrac{kT}{2\pi\hbar^2} \right)^{3/2}
\end{eqnarray}</div><p>From this point, we may compute the N-particle <em>canonical partition function</em> by</p>
<div class="math notranslate nohighlight">
\[Z_N = \dfrac{1}{N!}Z_{1-p}^N\]</div>
<p>and by using the fugacity parameter, defined by <span class="math notranslate nohighlight">\(z=e^{\mu/(kT)}\)</span>, we also may compute the <em>grand-canonical partition function</em>:</p>
<div class="math notranslate nohighlight">
\[\mathcal{Z} = \sum_{N=0} z^N Z_N = \sum_{N=0} \dfrac{(zZ_{1-p})^N}{N!} = \exp\left[e^{-mc^2/(kT)}\times zgV\left(\dfrac{kT}{2\pi \hbar^2} \right)^{3/2} \right]\]</div>
<p>with the associated grand-canonical potential:</p>
<div class="math notranslate nohighlight">
\[\Omega = -kT\log \mathcal{Z} = -kT gV\left(\dfrac{kT}{2\pi \hbar^2} \right)^{3/2} e^{\mu/(kT)}e^{-mc^2/(kT)}\]</div>
<p>and the number of particles may be computed as the first derivative of the grand-canonical potential with respect to the chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>:</p>
<div class="math notranslate nohighlight">
\[N = - \left( \dfrac{\partial \Omega}{\partial \mu} \right ) = gVm^{3/2}\left( \dfrac{kT}{2\pi \hbar^2} \right)^{3/2} e^{\mu/(kT)}e^{-mc^2/(kT)}\]</div>
<p>From the number density definition, <span class="math notranslate nohighlight">\(n=N/V\)</span> we may compute finally, the relationship between the number density and the chemical potential for a
semi-relativistic ideal gas by:</p>
<div class="math notranslate nohighlight">
\[n = gm^{3/2} \left( \dfrac{kT}{2\pi \hbar^2} \right)^{3/2} e^{\mu/(kT)}e^{-mc^2/(kT)}\]</div>
<p>or equivalently,</p>
<div class="math notranslate nohighlight">
\[\mu = kT \log \left[\dfrac{n}{g}\left( \dfrac{2\pi \hbar^2}{mkT} \right)^{3/2} \right] + mc^2\]</div>
<p>as summarized in <span id="id3">[<a class="reference internal" href="zreferences.html#id22" title="Thomas Rauscher and Friedrich-Karl Thielemann. Astrophysical Reaction Rates From Statistical Model Calculations. Atomic Data and Nuclear Data Tables, 75(1-2):1-351, May 2000. arXiv:astro-ph/0004059, doi:10.1006/adnd.2000.0834.">Rauscher and Thielemann, 2000</a>]</span>.</p>
</section>
<section id="reverse-rate-definition">
<h2>Reverse rate definition<a class="headerlink" href="#reverse-rate-definition" title="Link to this heading">#</a></h2>
<p>The forward and reverse reactions are entangled due to thermodynamical and nuclear equilibrium aspects. In this section we will see how this connection is introduced
and explore its consequences in the nuclear rates computation, as discussed in <span id="id4">[<a class="reference internal" href="zreferences.html#id22" title="Thomas Rauscher and Friedrich-Karl Thielemann. Astrophysical Reaction Rates From Statistical Model Calculations. Atomic Data and Nuclear Data Tables, 75(1-2):1-351, May 2000. arXiv:astro-ph/0004059, doi:10.1006/adnd.2000.0834.">Rauscher and Thielemann, 2000</a>]</span>. Starting with the reaction:</p>
<div class="math notranslate nohighlight">
\[A + B \rightarrow C\]</div>
<p>characterized by a positive Q-capture energy, we may define the reverse reaction as:</p>
<div class="math notranslate nohighlight">
\[C \rightarrow A + B\]</div>
<p>clearly characterized by a negative Q-capture energy. (It releases energy after the decay of C). Therefore, the rate of A and B particles in the forward reaction implies:</p>
<div class="math notranslate nohighlight">
\[\dfrac{dn_{AB}}{dt} = -n_An_B\langle \sigma v \rangle_{AB}\]</div>
<p>on the reverse reaction, we have:</p>
<div class="math notranslate nohighlight">
\[\dfrac{dn_C}{dt} = -\lambda_C n_C\]</div>
<p>Now, taking in consideration that in equilibrium, two equations are satisfied. First, the conservation of nucleons and second, the chemical potential balance:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\dfrac{dn_{AB}}{dt} - \dfrac{dn_c}{dt} = 0\\\mu_A + \mu_B = \mu_C\end{aligned}\end{align} \]</div>
<p>From, the first equation we get the following relationship between <span class="math notranslate nohighlight">\(\lambda_C\)</span> and <span class="math notranslate nohighlight">\(\langle \sigma v \rangle_{AB}\)</span> :</p>
<div class="math notranslate nohighlight">
\[\dfrac{n_A n_B}{n_C} = \dfrac{\lambda_C}{\langle \sigma v \rangle_{AB}}\]</div>
<p>Now, the left term of the previous equation may be computed by using the definition computed in the previous section, and the second equation:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
\dfrac{n_An_B}{n_C}&amp;=&amp;\left(\dfrac{m_Am_B}{m_C} \right)^{3/2}\dfrac{g_Ag_B}{g_C} \left(\dfrac{kT}{2\pi \hbar^2} \right)^{3/2} \times e^{(\mu_A+\mu_B-\mu_C)/(kT)} \times e^{-(m_A+m_B-m_C)c^2/(kT)}\\
                   &amp;=&amp;\left(\dfrac{m_Am_B}{m_C} \right)^{3/2}\dfrac{g_Ag_B}{g_C} \left(\dfrac{kT}{2\pi \hbar^2} \right)^{3/2} \times e^{-Q/(kT)}\\
                   &amp;=&amp;\left(\dfrac{A_AA_B}{A_C} \right)^{3/2}\dfrac{g_Ag_B}{g_C} \left(\dfrac{m_ukT}{2\pi \hbar^2}  \right)^{3/2} \times e^{-Q/(kT)}
\end{eqnarray}</div><p>Therefore, we can compute the photodisintegration rates using the capture rates by:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
\dfrac{\lambda_C}{N_a\langle \sigma v \rangle_{AB}} &amp;= \left(\dfrac{A_AA_B}{A_C} \right)^{3/2}\dfrac{g_Ag_B}{g_C} \left(\dfrac{m_ukT}{2\pi \hbar^2}  \right)^{3/2}\dfrac{1}{N_a} \times e^{-Q/(kT)}\\
                                                    &amp;= \left(\dfrac{A_AA_B}{A_C} \right)^{3/2}\dfrac{g_Ag_B}{g_C} T^{3/2}F \times e^{-Q/(kT)}
\end{eqnarray}</div><p>where the numerical factor <span class="math notranslate nohighlight">\(F\)</span> is defined by:</p>
<div class="math notranslate nohighlight">
\[T^{3/2}F = \left(\dfrac{m_ukT}{2\pi \hbar^2}  \right)^{3/2}\dfrac{1}{N_a}\]</div>
<p>Similarly, for a forward reaction:</p>
<div class="math notranslate nohighlight">
\[A + B \rightarrow C + D\]</div>
<p>we can compute the reverse rate <span class="math notranslate nohighlight">\(\langle \sigma v \rangle_{CD}\)</span> in terms of the forward rate <span class="math notranslate nohighlight">\(\langle \sigma v \rangle_{AB}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\dfrac{N_a\langle \sigma v \rangle_{CD}}{N_a\langle \sigma v \rangle_{AB}} = \left(\dfrac{A_AA_B}{A_CA_D} \right)^{3/2}\dfrac{g_Ag_B}{g_Cg_D}  \times e^{-Q/(kT)}\]</div>
</section>
<section id="partition-functions">
<h2>Partition functions<a class="headerlink" href="#partition-functions" title="Link to this heading">#</a></h2>
<p>Until now, we have not discussed the role of <span class="math notranslate nohighlight">\(g\)</span>, which encompasses the number of spin states that a particle may adopt. In reactions <span class="math notranslate nohighlight">\(i(j,o)m\)</span>  the target <span class="math notranslate nohighlight">\(i\)</span> and residual nucleus <span class="math notranslate nohighlight">\(m\)</span> contributes significantly more in the calculation of the rates than the incident and outgoing particles due to their complexity and the number of quantum levels they may assume. Therefore we may consider <span class="math notranslate nohighlight">\(\langle \sigma v \rangle_{ij} \rightarrow \langle \sigma v \rangle_i\)</span>  and  <span class="math notranslate nohighlight">\(\langle \sigma v \rangle_{om} \rightarrow \langle \sigma v \rangle_m\)</span>, which symbolize the nucleus <span class="math notranslate nohighlight">\(i\)</span>, or <span class="math notranslate nohighlight">\(m\)</span>, and all the remaining particles in their channels.</p>
<p>Using this notation, capture reactions rates of the type <span class="math notranslate nohighlight">\((p,\gamma)\)</span>, <span class="math notranslate nohighlight">\((n,\gamma)\)</span>, <span class="math notranslate nohighlight">\((\alpha,\gamma)\)</span>, and their reverse photodisintegration decay rates, are then related by:</p>
<div class="math notranslate nohighlight">
\[\dfrac{\lambda_{\gamma}}{N_a\langle \sigma v \rangle_i} = \left(\dfrac{A_iA_j}{A_m} \right)^{3/2}\dfrac{g_ig_j}{g_m} T^{3/2}F \times e^{-Q/(kT)}\]</div>
<p>otherwise, the forward and reaction rates are related by:</p>
<div class="math notranslate nohighlight">
\[\dfrac{N_a\langle \sigma v \rangle_m}{N_a\langle \sigma v \rangle_i} = \left(\dfrac{A_iA_j}{A_oA_m} \right)^{3/2}\dfrac{g_ig_j}{g_og_m}  \times e^{-Q/(kT)}\]</div>
<p>Now, the ingoing and outgoing are far apart in comparison with the nucleus size before the collision takes place; this allow us to assume that particles like <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(o\)</span> are in their ground state as they approach. Hence,
<span class="math notranslate nohighlight">\(g_j = (2J_j+1)\)</span> and <span class="math notranslate nohighlight">\(g_o = (2J_o + 1)\)</span> where <span class="math notranslate nohighlight">\(J_j\)</span> and <span class="math notranslate nohighlight">\(J_o\)</span> are the <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(o\)</span> particle spin in their respective ground state. However, the target and residual nucleus <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(m\)</span> particle spin, may be in a superposition of states due to excitation of upper levels caused by an steady increase of the temperature. As pointed out in <span id="id5">[<a class="reference internal" href="zreferences.html#id22" title="Thomas Rauscher and Friedrich-Karl Thielemann. Astrophysical Reaction Rates From Statistical Model Calculations. Atomic Data and Nuclear Data Tables, 75(1-2):1-351, May 2000. arXiv:astro-ph/0004059, doi:10.1006/adnd.2000.0834.">Rauscher and Thielemann, 2000</a>]</span>, we have to replace <span class="math notranslate nohighlight">\(g_i\rightarrow (2J_i+1)G_i\)</span> and <span class="math notranslate nohighlight">\(g_m\rightarrow (2J_m+1)G_m\)</span>, where</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
(2J_i+1)G_i &amp;=&amp; \sum_{\mu} (2J^{\mu}_i+1) \exp\left(-E_i^{\mu}/(kT)\right)\\
(2J_m+1)G_m &amp;=&amp; \sum_{\nu} (2J^{\nu}_m+1) \exp\left(-E_m^{\nu}/(kT)\right)
\end{eqnarray}</div><p>The quantities <span class="math notranslate nohighlight">\(G_i\)</span> and <span class="math notranslate nohighlight">\(G_j\)</span> are the target and residual partition functions that are normalized with respect to their ground state particle spin <span class="math notranslate nohighlight">\(J_i\)</span> and <span class="math notranslate nohighlight">\(J_m\)</span> respectively. Now, we are in position to write the following relationships between the forward and reverse rates:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
\lambda_{\gamma}{N_A \langle \sigma v \rangle_i} &amp;=&amp; \left(\dfrac{A_iA_j}{A_m} \right)^{3/2}\dfrac{(2J_i+1)(2J_j+1)}{(2J_m+1)} \dfrac{G_i}{G_m} T^{3/2}F \times e^{-Q/(kT)}\\
\dfrac{N_a\langle \sigma v \rangle_m}{N_a\langle \sigma v \rangle_i} &amp;=&amp; \left(\dfrac{A_iA_j}{A_oA_m} \right)^{3/2}\dfrac{(2J_i+1)(2J_j+1)}{(2J_o+1)(2J_m+1)} \dfrac{G_i}{G_m}  \times e^{-Q/(kT)}
\end{eqnarray}</div><p>or equivalently, after absorbing all the quantities in the forward rate with the exception of <span class="math notranslate nohighlight">\(G_i\)</span>:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
\lambda_{\gamma} &amp;=&amp; \lambda_{\gamma}'\dfrac{G_i}{G_m}\\
N_a\langle \sigma v \rangle_m &amp;=&amp; N_a\langle \sigma v \rangle_m' \dfrac{G_i}{G_m}
\end{eqnarray}</div><p>where the quantities <span class="math notranslate nohighlight">\(\lambda_{\gamma}'\)</span> and <span class="math notranslate nohighlight">\(N_a\langle \sigma v \rangle_m'\)</span> are provided by REACLIB, under the <code class="docutils literal notranslate"><span class="pre">-v</span></code> flag.</p>
</section>
<section id="implementing-partition-functions">
<h2>Implementing partition functions<a class="headerlink" href="#implementing-partition-functions" title="Link to this heading">#</a></h2>
<p>The partition function information is contained in three main classes:</p>
<ul class="simple">
<li><p><a class="reference internal" href="pynucastro.nucdata.html#pynucastro.nucdata.partition_function.PartitionFunction" title="pynucastro.nucdata.partition_function.PartitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartitionFunction</span></code></a> materialize the temperature and the partition function values into an object, interpolating across all the defined points using a cubic spline interpolation. If a temperature value is outside the temperature range, we keep its value constant to the nearest boundary value.</p></li>
<li><p><a class="reference internal" href="pynucastro.nucdata.html#pynucastro.nucdata.partition_function.PartitionFunctionTable" title="pynucastro.nucdata.partition_function.PartitionFunctionTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartitionFunctionTable</span></code></a>  reads a table and construct a dictionary between each nucleus and their partition function class object.</p></li>
<li><p><a class="reference internal" href="pynucastro.nucdata.html#pynucastro.nucdata.partition_function.PartitionFunctionCollection" title="pynucastro.nucdata.partition_function.PartitionFunctionCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartitionFunctionCollection</span></code></a> collects all the formatted table information, inside <code class="docutils literal notranslate"><span class="pre">/nucdata/PartitionFunction/</span></code>. It allow us to include the high temperature tables in <span id="id6">[<a class="reference internal" href="zreferences.html#id23" title="T. Rauscher. Nuclear partition functions at temperatures exceeding 10^10 K. The Astrophysical Journal Supplement Series, 147(2):403, August 2003. doi:10.1086/375733.">Rauscher, 2003</a>]</span> and to select the model used to compute the partition functions, respectively. By default, we include high temperatures, and our partition function model to be the <em>finite range droplet model (FRDM)</em>. If a nucleus is not in the collection, we set the partition function values to 1.0 by default.</p></li>
</ul>
<p>Inside the <a class="reference internal" href="pynucastro.nucdata.html#pynucastro.nucdata.nucleus.Nucleus" title="pynucastro.nucdata.nucleus.Nucleus"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nucleus</span></code></a> class, we have defined <code class="docutils literal notranslate"><span class="pre">set_partition_function()</span></code> which setup our partition function collection, our high temperatures consideration, and the model used to compute the partition function data. On the other hand, <code class="docutils literal notranslate"><span class="pre">get_partition_function()</span></code> assigns a partition function class object to the defined nucleus. Let us illustrate how it work:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pynucastro</span>

<span class="n">co46</span> <span class="o">=</span> <span class="n">pynucastro</span><span class="o">.</span><span class="n">rates</span><span class="o">.</span><span class="n">Nucleus</span><span class="p">(</span><span class="s1">&#39;co46&#39;</span><span class="p">)</span>
<span class="n">pCollection</span> <span class="o">=</span> <span class="n">pynucastro</span><span class="o">.</span><span class="n">nucdata</span><span class="o">.</span><span class="n">PartitionFunctionCollection</span><span class="p">()</span>

<span class="n">co46</span><span class="o">.</span><span class="n">set_partition_function</span><span class="p">(</span><span class="n">pCollection</span><span class="o">=</span><span class="n">pCollection</span><span class="p">,</span> <span class="n">set_data</span><span class="o">=</span><span class="s1">&#39;etfsiq&#39;</span><span class="p">,</span> <span class="n">use_high_temperatures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pf_co46</span> <span class="o">=</span> <span class="n">co46</span><span class="o">.</span><span class="n">get_partition_function</span><span class="p">()</span>
</pre></div>
</div>
<p>Now, from this point we define a method inside a <a class="reference internal" href="pynucastro.rates.html#pynucastro.rates.rate.Rate" title="pynucastro.rates.rate.Rate"><code class="xref py py-class docutils literal notranslate"><span class="pre">Rate</span></code></a> named <code class="docutils literal notranslate"><span class="pre">set_partition_function()</span></code> which reads a partition function collection
and setup all the nucleus inside the reaction rate. Let us illustrate now, how it works:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pynucastro</span>

<span class="n">p_collection</span> <span class="o">=</span> <span class="n">pynucastro</span><span class="o">.</span><span class="n">nucdata</span><span class="o">.</span><span class="n">PartitionFunctionCollection</span><span class="p">()</span>

<span class="n">o18_pg_f19</span> <span class="o">=</span> <span class="n">pynucastro</span><span class="o">.</span><span class="n">rates</span><span class="o">.</span><span class="n">Rate</span><span class="p">(</span><span class="s1">&#39;../library/o18-pg-f19-il10&#39;</span><span class="p">)</span>
<span class="n">o18_pg_f19</span><span class="o">.</span><span class="n">set_partition_function</span><span class="p">(</span><span class="n">p_collection</span><span class="o">=</span><span class="n">p_collection</span><span class="p">,</span> <span class="n">set_data</span><span class="o">=</span><span class="s1">&#39;frdm&#39;</span><span class="p">,</span> <span class="n">use_high_temperatures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">o18_pg_f19</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">o18</span> <span class="o">=</span> <span class="n">o18_pg_f19</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">f19</span> <span class="o">=</span> <span class="n">o18_pg_f19</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">pf_p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_partition_function</span><span class="p">()</span>
<span class="n">pf_o18</span> <span class="o">=</span> <span class="n">o18</span><span class="o">.</span><span class="n">get_partition_function</span><span class="p">()</span>
<span class="n">pf_f19</span> <span class="o">=</span> <span class="n">f19</span><span class="o">.</span><span class="n">get_partition_function</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="custom-rates.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Creating a Custom Rate</p>
      </div>
    </a>
    <a class="right-next"
       href="approximate-rates.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Approximate Rates</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#semi-relativistic-ideal-gas-model">Semi-relativistic ideal gas model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reverse-rate-definition">Reverse rate definition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-functions">Partition functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-partition-functions">Implementing partition functions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By pynucastro development team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, pynucastro development team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>